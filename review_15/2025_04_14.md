### 우리FISA 15주차 학습기록

#### ( 2025.04.14 ~ 2025.04.18 )

---

##### 2025.04.14. Mon
#### jenkins 툴 활용하는 방법

로드 밸런서 = nigix의 기능

#### VPC
VPC -> VPC 생성 -> VPC 등

#### AWS Auto Scaling의 과정
1. 대상 그룹(Target Group) 생성
대상 그룹: 로드밸런서(ALB)가 트래픽을 분산시킬 대상 그룹 (EC2 인스턴스의 리스트)
VM 단위로 관리 : 인스턴스 선택, 컨테이너 단위 관리 : IP 주소 사용

2. 로드밸런서(ALB) 생성
- 로드밸런서의 역할 : 헬스 체크로 EC2 인스턴스의 상태를 확인하고 비정상 인스턴스는 자동 제외
연결된 대상그룹에 헬스체크를 주기적으로 보냄 ➡ 비정상적인 인스턴스엔 트래픽 안 보내고 제외
- ALB는 트래픽을 대상 그룹의 여러 인스턴스에 분산
생성 시, 대상 그룹을 연결해준다.
- ALB는 인터넷에서 접근 가능해야 하니까 퍼블릭 서브넷

3. AMI 생성
배포에 사용할 EC2 인스턴스를 생성한 후, AMI(이미지)로 만들어 저장한다.

4. 시작 템플릿(Launch Templates) 생성
- Auto Scaling을 쓰려면 시작 템플릿이 반드시 필요
➡ Auto Scaling Group은 EC2를 자동으로 생성하고 삭제하니까, **어떤 설정으로 EC2를 만들지**가 필요
그래서 반드시 시작 템플릿(Launch Template) 이 필요하고, 템플릿엔 AMI ID를 포함해야 함
- 시작 템플릿에 변경사항이 있다면 최신 버전으로 기본(default) 설정을 변경하여 Auto Scaling 그룹에서 자동 반영되도록 수정해야한다.

5. Auto Scaling 그룹 생성
시작 템플릿을 지정
서브넷 선택(Private 서브넷)
만들어 둔 로드밸런서와 연결
💡 Auto Scaling 인스턴스를 짝수 개로 설정하는 이유
 Auto Scaling 그룹이 여러 가용 영역(AZ) 에 인스턴스를 분산할 때, 짝수 개수로 구성해야 각 AZ에 균형 있게 분배되기 때문.

6. 부하 테스트로 스케일링 유도
`apt-get update`
`apt install wrk`
`wrk -t2 -c30 -d30s http://로드밸런서주소`
`# 옵션 : -t <threads> / -c <connections> / -d <duration>`

7. EC2 > Auto Scaling 그룹 > 해당 그룹 > 모니터링 탭에서 확인한다.


Auto Scaling으로 생성되는 EC2 인스턴스들은 보안상 프라이빗 서브넷에 두고, ALB가 프라이빗 서브넷의 인스턴스로 트래픽을 내부 전달해주는 구조

[인터넷 사용자]
       ↓
[ ALB (퍼블릭 서브넷) ]
       ↓
[ EC2 (프라이빗 서브넷, Auto Scaling) ]
